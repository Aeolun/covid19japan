!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r(r.s=0)}([function(e,t,r){r(1),e.exports=r(2)},function(e,t){mapboxgl.accessToken="pk.eyJ1IjoicmV1c3RsZSIsImEiOiJjazZtaHE4ZnkwMG9iM3BxYnFmaDgxbzQ0In0.nOiHGcSCRNa9MD9WxLIm7g";let r="en",n={prefectures:void 0,trend:void 0,totals:{confirmed:0,recovered:0,deceased:0,tested:0,critical:0},totalsDiff:{confirmed:0,recovered:0,deceased:0,tested:0,critical:0}},o=void 0;function a(e,t){let n=document.querySelector("#prefectures-table tbody"),o="";n.innerHTML="",_.map(e,(function(e){e.confirmed=e.cases?parseInt(e.cases):0,e.recovered=e.recovered?parseInt(e.recovered):0,e.deceased=e.deaths?parseInt(e.deaths):0})),_.orderBy(e,"confirmed","desc").map((function(e){if(!e.confirmed&&!e.recovered&&!e.deceased)return;let t;return t="en"==r?e.prefecture:e.prefectureja,"Unspecified"==e.prefecture?o="<tr><td><em>"+t+"</em></td><td>"+e.confirmed+"</td><td>"+e.recovered+"</td><td>"+e.deaths+"</td></tr>":"Total"==e.prefecture||(n.innerHTML=n.innerHTML+"<tr><td>"+t+"</td><td>"+e.confirmed+"</td><td></td><td>"+(e.deceased?e.deceased:"")+"</td></tr>"),!0})),n.innerHTML=n.innerHTML+o;let a="Total";"ja"==r&&(a="è¨ˆ"),n.innerHTML=n.innerHTML+"<tr class='totals'><td>"+a+"</td><td>"+t.confirmed+"</td><td>"+t.recovered+"</td><td>"+t.deceased+"</td></tr>"}"NodeList"in window&&!NodeList.prototype.forEach&&(console.info("polyfill for IE11"),NodeList.prototype.forEach=function(e,t){t=t||window;for(var r=0;r<this.length;r++)e.call(t,this[r],r,this)}),window.onload=function(){tippy("[data-tippy-content]"),function(){const e=function(e){document.querySelectorAll("[data-ja]").forEach(e)};e((function(e){e.dataset.en=e.textContent})),document.querySelectorAll("[data-lang-picker]").forEach((function(t){t.addEventListener("click",(function(t){t.preventDefault(),r=t.target.dataset.langPicker,e((function(e){e.dataset[r]&&(e.textContent=e.dataset[r])})),o.getStyle().layers.forEach((function(e){"symbol"==e.type&&o.setLayoutProperty(e.id,"text-field",["get","name_"+r])})),document.getElementById("prefectures-table")&&a(n.prefectures,n.totals),document.querySelectorAll("a[data-lang-picker]").forEach((function(e){e.style.display="inline"})),document.querySelector("a[data-lang-picker="+r+"]").style.display="none"}))}))}(),o=new mapboxgl.Map({container:"map-container",style:"mapbox://styles/mapbox/light-v10",zoom:4,minZoom:3.5,maxZoom:7,center:{lng:139.11792973051274,lat:38.52245616545571},maxBounds:[{lat:12.118318014416644,lng:100.01240618330542},{lat:59.34721256263214,lng:175.3273570446982}]}),o.dragRotate.disable(),o.touchZoomRotate.disableRotation(),o.scrollZoom.disable(),o.addControl(new mapboxgl.NavigationControl({showCompass:!1,showZoom:!0}));var e=0,t=!1,c=void 0;function d(){t&&c&&function(e){for(var t,r=o.getStyle().layers,a=0;a<r.length;a++)if("symbol"===r[a].type){t=r[a].id;break}let c=["match",["get","NAME_1"]];if(n.prefectures.map((function(e){let t=parseInt(e.cases);t>0&&(c.push(e.prefecture),t<=10?c.push("rgb(253,234,203)"):t<=25?c.push("rgb(251,155,127)"):t<=50?c.push("rgb(244,67,54)"):c.push("rgb(186,0,13)"))})),c.push("rgba(0,0,0,0)"),0===e){o.addSource("prefectures",{type:"geojson",data:"static/prefectures.geojson"}),o.addLayer({id:"prefecture-layer",type:"fill",source:"prefectures",layout:{},paint:{"fill-color":c,"fill-opacity":.8}},t);o.addLayer({id:"prefecture-outline-layer",type:"line",source:"prefectures",layout:{},paint:{"line-width":.5,"line-color":"#c0c0c0","line-opacity":.5}},t)}else o.setPaintProperty("prefecture-layer","fill-color",c)}(e)}function i(){var e;e=function(e){c=e,n.prefectures=c.prefectures;let t=function(e){let t={confirmed:0,recovered:0,deceased:0,critical:0,tested:0},r={confirmed:1,recovered:1,deceased:1,critical:1,tested:1};function n(n){e[e.length-1][n].length?(t[n]=parseInt(e[e.length-1][n]),r[n]=t[n]-parseInt(e[e.length-2][n])):(t[n]=parseInt(e[e.length-2][n]),r[n]=t[n]-parseInt(e[e.length-3][n]))}return n("tested"),n("critical"),n("confirmed"),n("recovered"),n("deceased"),[t,r]}(c.daily);var r,o;n.totals=t[0],n.totalsDiff=t[1],n.trend=c.daily,n.lastUpdated=c.updated[0].lastupdated,function(e,t){function r(e,t){document.querySelector("#kpi-"+e+" .value").innerHTML=t}function n(e,t){let r=t>=0?"+":"";document.querySelector("#kpi-"+e+" .diff").innerHTML="( "+r+t+" )"}r("confirmed",e.confirmed),n("confirmed",t.confirmed),r("recovered",e.recovered),n("recovered",t.recovered),r("deceased",e.deceased),n("deceased",t.deceased),r("critical",e.critical),n("critical",t.critical),r("tested",e.tested),n("tested",t.tested),r("active",e.confirmed-e.recovered-e.deceased),n("active",t.confirmed-t.recovered-t.deceased)}(n.totals,n.totalsDiff),document.body.classList.contains("embed-mode")||(o=n.lastUpdated,document.getElementById("last-updated").innerHTML=o,r=n.totals.confirmed,document.title="("+r+") Coronavirus Disease (COVID-19) Japan Tracker",a(n.prefectures,n.totals),function(e){for(var t={Date:["Date"],Confirmed:["Confirmed"],Active:["Active"],Critical:["Critical"],Deceased:["Deceased"],Recovered:["Recovered"],Tested:["Tested"]},r=0;r<e.length;r++){var n=e[r];0!==r&&(t.Date.push(n.date),t.Confirmed.push(parseInt(n.confirmed)),t.Critical.push(parseInt(n.critical)),t.Deceased.push(parseInt(n.deceased)),t.Recovered.push(parseInt(n.recovered)),t.Active.push(parseInt(n.confirmed)-parseInt(n.deceased)-parseInt(n.recovered)))}c3.generate({bindto:"#trend-chart",data:{x:"Date",columns:[t.Date,t.Confirmed,t.Active,t.Recovered,t.Deceased]},color:{pattern:["rgb(244,67,54)","rgb(223,14,31)","rgb(25,118,210)","rgb(55,71,79)"]},point:{r:3},axis:{x:{type:"timeseries",tick:{format:"%b %d",count:6}},y:{tick:{values:[0,100,500,1e3,1500,2e3,2500,3e3,3500,4e3,4500,5e3]}}},tooltip:{format:{value:function(e,r,n,o){if(o&&t[n][o]){var a=parseInt(e)-t[n][o];return e+" ("+(a>=0?"+":"")+a+")"}return e}}},grid:{x:{show:!0},y:{show:!0}}})}(n.trend)),d()},fetch("https://covid19japan.s3.ap-northeast-1.amazonaws.com/data.json").then((function(e){return e.json()})).then((function(t){e(t)}))}o.once("style.load",(function(e){t=!0,d()})),i(),setInterval((function(){e++,i()}),3e5)}},function(e,t,r){}]);